(function(){function define(custEl){var tagName=custEl.is;if(customElements.get(tagName)){console.warn("Already registered "+tagName);return}customElements.define(tagName,custEl)}var disabled="disabled";var input="input",delay="delay",XtalInsertJson=function(_WithPath){babelHelpers.inherits(XtalInsertJson,_WithPath);function XtalInsertJson(){babelHelpers.classCallCheck(this,XtalInsertJson);return babelHelpers.possibleConstructorReturn(this,(XtalInsertJson.__proto__||Object.getPrototypeOf(XtalInsertJson)).apply(this,arguments))}babelHelpers.createClass(XtalInsertJson,[{key:"attributeChangedCallback",value:function attributeChangedCallback(name,oldVal,newVal){switch(name){case input:this.input=JSON.parse(newVal);break;case"with-path":this._withPath=newVal;break;case delay:this._delay=parseFloat(newVal);break;}babelHelpers.get(XtalInsertJson.prototype.__proto__||Object.getPrototypeOf(XtalInsertJson.prototype),"attributeChangedCallback",this).call(this,name,oldVal,newVal);this.onPropChange()}},{key:"loadJSON",value:function loadJSON(callBack){var _this3=this,scriptTag=this.querySelector("script[type=\"application/json\"]");if(!scriptTag){setTimeout(function(){_this3.loadJSON(callBack)},100);return}var stringToParse=scriptTag.innerText;if(!this._objectsToMerge){try{if(this.refs){this._objectsToMerge=JSON.parse(stringToParse,function(key,val){if("string"!==typeof val)return val;if(!val.startsWith("${refs.")||!val.endsWith("}"))return val;var realKey=val.substring(7,val.length-1);return _this3.refs[realKey]})}else{if(!this._objectsToMerge)this._objectsToMerge=JSON.parse(stringToParse)}}catch(e){console.error("Unable to parse "+stringToParse)}}callBack()}},{key:"postLoadJson",value:function postLoadJson(mergedObj){if(this._objectsToMerge&&mergedObj){for(var i=0,ii=this._objectsToMerge.length,objToMerge;i<ii;i++){objToMerge=this._objectsToMerge[i];Object.assign(mergedObj,objToMerge)}}this.mergedProp=mergedObj}},{key:"onPropChange",value:function onPropChange(){var _this4=this;if(!this._connected||this._disabled||!this._input)return;var mergedObj=this.wrap(this._input);this.loadJSON(function(){_this4.postLoadJson(mergedObj)})}},{key:"connectedCallback",value:function connectedCallback(){this._upgradeProperties([delay,input,"refs","withPath","postMergeCallbackFn"]);this._connected=!0;this.onPropChange()}},{key:"input",get:function get(){return this._input},set:function set(val){var _this5=this;if(this._delay){setTimeout(function(){_this5._input=val;_this5.onPropChange()},this._delay)}else{this._input=val;this.onPropChange()}}},{key:"refs",get:function get(){return this._refs},set:function set(val){this._refs=val;delete this._objectsToMerge;this.onPropChange()}},{key:"mergedProp",get:function get(){return this._mergedProp},set:function set(val){var newVal=val;if(this._postMergeCallbackFn){newVal=this._postMergeCallbackFn(val,this);if(!newVal)return}this.value=this._mergedProp=newVal;this.de("merged-prop",{value:newVal})}},{key:"postMergeCallbackFn",get:function get(){return this._postMergeCallbackFn},set:function set(){this._postMergeCallbackFn}},{key:"delay",get:function get(){return this._delay},set:function set(newVal){this.attr(delay,newVal.toString())}},{key:"objectsToMerge",get:function get(){return this._objectsToMerge},set:function set(val){this._objectsToMerge=val}}],[{key:"is",get:function get(){return"xtal-insert-json"}},{key:"observedAttributes",get:function get(){return babelHelpers.get(XtalInsertJson.__proto__||Object.getPrototypeOf(XtalInsertJson),"observedAttributes",this).concat([delay,"with-path",input])}}]);return XtalInsertJson}(WithPath(function(superClass){return function(_superClass){babelHelpers.inherits(_class,_superClass);function _class(){var _this;babelHelpers.classCallCheck(this,_class);_this=babelHelpers.possibleConstructorReturn(this,(_class.__proto__||Object.getPrototypeOf(_class)).apply(this,arguments));_this._evCount={};return _this}babelHelpers.createClass(_class,[{key:"attr",value:function attr(name,val,trueVal){var v=val?"set":"remove";this[v+"Attribute"](name,trueVal||val)}},{key:"to$",value:function to$(n){var mod=n%2;return(n-mod)/2+"-"+mod}},{key:"incAttr",value:function incAttr(name){var ec=this._evCount;if(name in ec){ec[name]++}else{ec[name]=0}this.attr("data-"+name,this.to$(ec[name]))}},{key:"attributeChangedCallback",value:function attributeChangedCallback(name,oldVal,newVal){switch(name){case disabled:this._disabled=null!==newVal;break;}}},{key:"de",value:function de(name,detail,asIs){var eventName=name+(asIs?"":"-changed"),newEvent=new CustomEvent(eventName,{detail:detail,bubbles:!0,composed:!1});this.dispatchEvent(newEvent);this.incAttr(eventName);return newEvent}},{key:"_upgradeProperties",value:function _upgradeProperties(props){var _this2=this;props.forEach(function(prop){if(_this2.hasOwnProperty(prop)){var value=_this2[prop];delete _this2[prop];_this2[prop]=value}})}},{key:"disabled",get:function get(){return this._disabled},set:function set(val){this.attr(disabled,val,"")}}],[{key:"observedAttributes",get:function get(){return[disabled]}}]);return _class}(superClass)}(HTMLElement)));define(XtalInsertJson);var pass_thru_on_init="pass-thru-on-init",XtalJSONMerge=function(_XtalInsertJson){babelHelpers.inherits(XtalJSONMerge,_XtalInsertJson);function XtalJSONMerge(){babelHelpers.classCallCheck(this,XtalJSONMerge);return babelHelpers.possibleConstructorReturn(this,(XtalJSONMerge.__proto__||Object.getPrototypeOf(XtalJSONMerge)).apply(this,arguments))}babelHelpers.createClass(XtalJSONMerge,[{key:"connectedCallback",value:function connectedCallback(){this._upgradeProperties(["passThruOnInit"]);babelHelpers.get(XtalJSONMerge.prototype.__proto__||Object.getPrototypeOf(XtalJSONMerge.prototype),"connectedCallback",this).call(this)}},{key:"attributeChangedCallback",value:function attributeChangedCallback(name,oldVal,newVal){babelHelpers.get(XtalJSONMerge.prototype.__proto__||Object.getPrototypeOf(XtalJSONMerge.prototype),"attributeChangedCallback",this).call(this,name,oldVal,newVal);switch(name){case pass_thru_on_init:this._passThruOnInit=null!==newVal;break;}}},{key:"postLoadJson",value:function postLoadJson(mergedObj){if(this._objectsToMerge&&mergedObj){for(var i=0,ii=this._objectsToMerge.length,objToMerge;i<ii;i++){objToMerge=this._objectsToMerge[i];switch(babelHelpers.typeof(objToMerge)){case"object":this.mergeDeep(mergedObj,objToMerge);break;default:throw"TODO:  error message";}}}this.mergedProp=mergedObj}},{key:"getParent",value:function getParent(){return this.parentElement}},{key:"mergeDeep",value:function mergeDeep(target,source){if("object"!==babelHelpers.typeof(target))return;if("object"!==babelHelpers.typeof(source))return;for(var key in source){var sourceVal=source[key],targetVal=target[key];if(!sourceVal)continue;if(!targetVal){target[key]=sourceVal;continue}if(Array.isArray(sourceVal)&&Array.isArray(targetVal)){if(0<targetVal.length&&"undefined"===typeof targetVal[0].id)continue;for(var i=0,ii=sourceVal.length;i<ii;i++){sourceVal[i]}continue}switch(babelHelpers.typeof(sourceVal)){case"object":switch(babelHelpers.typeof(targetVal)){case"object":this.mergeDeep(targetVal,sourceVal);break;default:target[key]=sourceVal;break;}break;default:target[key]=sourceVal;}}return target}},{key:"passThruOnInit",get:function get(){return this._passThruOnInit},set:function set(val){this.attr(pass_thru_on_init,val,"")}}],[{key:"is",get:function get(){return"xtal-json-merge"}},{key:"observedAttributes",get:function get(){return babelHelpers.get(XtalJSONMerge.__proto__||Object.getPrototypeOf(XtalJSONMerge),"observedAttributes",this).concat(["pass-thru-on-init"])}}]);return XtalJSONMerge}(XtalInsertJson);define(XtalJSONMerge)})();