var input="input",with_path="with-path",delay="delay",pass_down="pass-down",disabled="disabled";export var XtalInsertJson=function(_HTMLElement){babelHelpers.inherits(XtalInsertJson,_HTMLElement);function XtalInsertJson(){babelHelpers.classCallCheck(this,XtalInsertJson);return babelHelpers.possibleConstructorReturn(this,(XtalInsertJson.__proto__||Object.getPrototypeOf(XtalInsertJson)).apply(this,arguments))}babelHelpers.createClass(XtalInsertJson,[{key:"de",value:function de(val){var mergedObjectChangedEvent=new CustomEvent("merged-prop-changed",{detail:{value:val},bubbles:!0,composed:!1});return mergedObjectChangedEvent}},{key:"attributeChangedCallback",value:function attributeChangedCallback(name,oldVal,newVal){switch(name){case input:this.input=JSON.parse(newVal);break;case with_path:this._withPath=newVal;break;case delay:this._delay=parseFloat(newVal);break;case pass_down:this._passDown=newVal;this.parsePassDown();break;case disabled:this._disabled=null!==newVal;break;}this.onPropChange()}},{key:"loadJSON",value:function loadJSON(callBack){var _this=this,scriptTag=this.querySelector("script[type=\"application/json\"]");if(!scriptTag){setTimeout(function(){_this.loadJSON(callBack)},100);return}var stringToParse=scriptTag.innerText;try{if(this.refs){this._objectsToMerge=JSON.parse(stringToParse,function(key,val){if("string"!==typeof val)return val;if(!val.startsWith("${refs.")||!val.endsWith("}"))return val;var realKey=val.substring(7,val.length-1);return _this.refs[realKey]})}else{this._objectsToMerge=JSON.parse(stringToParse)}}catch(e){console.error("Unable to parse "+stringToParse)}callBack()}},{key:"postLoadJson",value:function postLoadJson(mergedObj){if(this._objectsToMerge&&mergedObj){for(var i=0,ii=this._objectsToMerge.length,objToMerge;i<ii;i++){objToMerge=this._objectsToMerge[i];Object.assign(mergedObj,objToMerge)}}this.mergedProp=mergedObj}},{key:"onPropChange",value:function onPropChange(){var _this2=this;if(!this._connected||this._disabled)return;var mergedObj;if(this._withPath){mergedObj={};var splitPath=this._withPath.split("."),lenMinus1=splitPath.length-1;splitPath.forEach(function(pathToken,idx){if(idx===lenMinus1){mergedObj[pathToken]=_this2._input}else{mergedObj=mergedObj[pathToken]={}}})}else{mergedObj=this._input}this.loadJSON(function(){_this2.postLoadJson(mergedObj)})}},{key:"_upgradeProperties",value:function _upgradeProperties(props){var _this3=this;props.forEach(function(prop){if(_this3.hasOwnProperty(prop)){var value=_this3[prop];delete _this3[prop];_this3[prop]=value}})}},{key:"connectedCallback",value:function connectedCallback(){this._upgradeProperties([delay,input,"refs","withPath","passDown","postMergeCallbackFn"]);this._connected=!0;this.onPropChange()}},{key:"parsePassDown",value:function parsePassDown(){var _this4=this;this.cssKeyMappers=[];var splitPassDown=this._passDown.split("};");splitPassDown.forEach(function(passDownSelectorAndProp){if(!passDownSelectorAndProp)return;var splitPassTo2=passDownSelectorAndProp.split("{");_this4.cssKeyMappers.push({cssSelector:splitPassTo2[0],propTarget:splitPassTo2[1]})})}},{key:"input",get:function get(){return this._input},set:function set(val){var _this5=this;this._input=val;if(this._delay){setTimeout(function(){_this5.onPropChange()},this._delay)}else{this.onPropChange()}}},{key:"refs",get:function get(){return this._refs},set:function set(val){this._refs=val}},{key:"mergedProp",get:function get(){return this._mergedProp},set:function set(val){var _this6=this;this._mergedProp=val;if(this.cssKeyMappers){var _ret=function(){var nextSibling=_this6.nextElementSibling;while(nextSibling){_this6.cssKeyMappers.forEach(function(map){if(nextSibling.matches(map.cssSelector)){nextSibling[map.propTarget]=val}});nextSibling=nextSibling.nextElementSibling}return{v:void 0}}();if("object"===babelHelpers.typeof(_ret))return _ret.v}var mergedObjectChangedEvent=this.de(val);if(this._postMergeCallbackFn){this._postMergeCallbackFn(mergedObjectChangedEvent,this);return}this.dispatchEvent(mergedObjectChangedEvent)}},{key:"postMergeCallbackFn",get:function get(){return this._postMergeCallbackFn},set:function set(){this._postMergeCallbackFn}},{key:"withPath",get:function get(){return this._withPath},set:function set(val){this.setAttribute(with_path,val)}},{key:"delay",get:function get(){return this._delay},set:function set(newVal){this.setAttribute(delay,newVal.toString())}},{key:"passDown",get:function get(){return this._passDown},set:function set(val){this.setAttribute(pass_down,val)}},{key:"disabled",get:function get(){return this._disabled},set:function set(val){if(val){this.setAttribute(disabled,"")}else{this.removeAttribute(disabled)}}}],[{key:"is",get:function get(){return"xtal-insert-json"}},{key:"observedAttributes",get:function get(){return[delay,with_path,input,pass_down,disabled]}}]);return XtalInsertJson}(HTMLElement);if(!customElements.get(XtalInsertJson.is)){customElements.define(XtalInsertJson.is,XtalInsertJson)}